<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Articles</title>

  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/articles/articleIndex.css">
</head>
<body>
  <%- include("../partials/header") %>

  <main class="container">
    <h1>üìù My Articles</h1>
     
    <div class="articles-grid">
      <% articles.forEach(article => { %>
        <div class="article-card">
          <% if (article.image) { %>
            <img src="<%= article.image %>" alt="<%= article.title %>" class="article-image">
          <% } else { %>
            <img src="https://via.placeholder.com/300x180?text=No+Image" class="article-image">
          <% } %>

          <div class="article-content">
            <h2 class="article-title">
              <a href="/articles/<%= article._id %>"><%= article.title %></a>
            </h2>

            <p class="article-meta">
              By <%= article.authorId ? article.authorId.name : "Unknown" %> 
              | <%= new Date(article.createdAt).toLocaleDateString() %>
            </p>

            <p class="article-snippet">
              <%= article.content ? article.content.substring(0,120) + "..." : "Read more" %>
            </p>

            <% if (user && article.authorId && article.authorId._id.toString() === user._id.toString()) { %>
              <div class="article-actions">
                <a href="/articles/edit/<%= article._id %>" class="btn edit">Edit</a>
                <form action="/articles/delete/<%= article._id %>" method="POST" style="display:inline;">
                  <button type="submit" class="btn delete">Delete</button>
                </form>
              </div>
            <% } %>
          </div>
        </div>
      <% }) %>
    </div>
  </main>
   
</body>
</html>
